<If Condition="!Props.Schedule.Any()">
    <Then>
        <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="100px" Class="mb-2" />
        <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="100px" Class="mb-2" />
        <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="100px" Class="mb-2" />
        <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="100px" Class="mb-2" />
        <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="100px" Class="mb-2" />
        <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="100px" Class="mb-2" />
    </Then>
    <Else>
        <MudExpansionPanels MultiExpansion="true">
            @foreach (var scheduleItem in Props.Schedule)
            {
                <ExercisePanel Schedule="scheduleItem" ControlContext="_controlContext" PreviousSessionLog="Props.PreviousSessionLog" TodayLogByExercise="Props.TodayLogByExercise" />
            }
        </MudExpansionPanels>
        <ExerciseSelectorForm ActionText="Add exercise" Exercises="Props.AllExercises" OnExerciseSelected="OnAddExercise" />
    </Else>
</If>

@code{
    ExerciseControlContext _controlContext = new ExerciseControlContext(null, null, null, null);

    [Parameter]
    public ExerciseScheduleProps Props { get; set; }

    protected override void OnParametersSet()
    {
        _controlContext = new ExerciseControlContext(Props.AddExercise, Props.RemoveExercise, Props.Save, Props.SetScheduleTargetSets);
    }

    private async Task OnAddExercise(ExerciseViewModel exercise)
    {
        await Props.AddExercise(new SpecificExerciseSelector(exercise.Id));
    }
}
